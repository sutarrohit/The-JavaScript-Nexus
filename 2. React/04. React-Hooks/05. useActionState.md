# ðŸ“˜ `useActionState`

## 1. **What is `useActionState`?**

-   `useActionState` is a React hook introduced to handle **asynchronous form submissions and actions** with built-in state management.
-   Itâ€™s mainly used with **Server Actions** in React / Next.js but can also be used for client-side actions.
-   Think of it as a hook that combines:

    -   `useState` â†’ to keep track of the result of an action
    -   `useTransition` â†’ to track the pending state of async actions

---

## 2. **Syntax**

```tsx
const [state, action, isPending] = useActionState(actionFn, initialState);
```

### Arguments

1. **`actionFn`** â†’ A function (usually async) that performs an action (e.g., submitting a form).
2. **`initialState`** â†’ The starting state (can be `null`, `{}`, or any value).

### Returns

1. **`state`** â†’ Holds the latest result of the action (error, success message, data, etc.).
2. **`action`** â†’ A function you call to trigger the action (works like an event handler).
3. **`isPending`** â†’ Boolean (`true` while actionFn is running, `false` after completion).

---

## 3. **When to use `useActionState`**

-   Handling **form submissions** (login, signup, etc.).
-   Running **async server actions** in Next.js App Router.
-   Displaying **loading state** while the action runs.
-   Managing **error/success messages** returned from an action.

---

## 4. **Example (Form Submission with Validation)**

```tsx
"use client";
import { useActionState } from "react";

type ActionState = {
    error?: string;
    message?: string;
    email?: string;
};

// Fake async action
async function submitFormFn(prevState: ActionState, formData: FormData) {
    const email = formData.get("email")?.toString();

    if (!email || !email.includes("@")) {
        return { error: "Invalid email address" };
    }

    return { message: "Form submitted successfully", email };
}

export default function ReactActionState() {
    const [data, formAction, isPending] = useActionState<ActionState>(submitFormFn, {});

    return (
        <form action={formAction}>
            <input name='email' type='email' placeholder='Enter email' />
            <button disabled={isPending}>{isPending ? "Submitting..." : "Submit"}</button>

            {data?.error && <p style={{ color: "red" }}>{data.error}</p>}
            {data?.message && <p style={{ color: "green" }}>{data.message}</p>}
        </form>
    );
}
```

---

## 5. **How it works internally**

1. **Initial render:**

    - `data = initialState`
    - `isPending = false`

2. **When `formAction` is called:**

    - React runs `submitFormFn` with `(prevState, formData)`.
    - `isPending = true`

3. **After async finishes:**

    - The return value of `submitFormFn` replaces `data`.
    - `isPending = false`

---

## 6. **Comparison with other hooks**

| Hook             | Purpose                                                                       |
| ---------------- | ----------------------------------------------------------------------------- |
| `useState`       | Stores local component state.                                                 |
| `useTransition`  | Tracks async state transitions, useful for showing loading.                   |
| `useActionState` | Combines `useState` + `useTransition` to manage form/action lifecycle easily. |

---

## 7. **Key Benefits**

âœ… Handles async action results automatically.
âœ… Built-in **loading state** (`isPending`).
âœ… Works well with **Next.js Server Actions**.
âœ… Simplifies **form handling** compared to manual `useState`.

---

## 8. **Best Practices**

-   Always define a **clear return shape** (e.g., `{ error, message }`) to avoid confusion.
-   Use **TypeScript types** for strong typing of the `state`.
-   Use `isPending` to disable buttons while submitting (prevents double submission).
-   Handle both **success and error states** in UI.

---

## 9. **Real-world Use Cases**

-   **Login/Register forms** (with server validation).
-   **Contact form** with success/error messages.
-   **Profile update forms** (showing updated state after action).
-   **Async operations** like API calls, sending emails, file uploads.

---

ðŸ‘‰ In short:
`useActionState` = `useState` + `useTransition` + `form handling` all in one, especially made for **actions** (client or server) in modern React.
